#!/usr/bin/env ruby
# -*- coding: utf-8 -*-

=begin
Usage: uhadoop [-c <num>] <server-group>
uhadoop tumf-sg-13 jar ./hadoop/contrib/streaming/hadoop-0.20.2-streaming.jar \
    -input input -output output -mapper './bin/mapper' -reducer './bin/reducer'

=end
require 'bin/cluster_manager.rb'

HADOOP_VERSION="0.20.2"
group = ARGV.shift

c = ClusterManger.new(group)
#puts("ssh hadoop@%s \"cd hadoop && ./hadoop/bin/hadoop %s\"" % [c.master.ipInfo?[0]["route_to"], ARGV.join(" ")])
system("ssh hadoop@%s \"cd hadoop && ./hadoop/bin/hadoop %s\"" % [c.master.ipInfo?[0]["route_to"], ARGV.join(" ")])




